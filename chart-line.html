<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Báo cáo doanh thu năm 2022</title>

  <link rel="stylesheet" href="media/sass/style.css">
  <link href="//fonts.googleapis.com/css?family=Roboto:300" rel="stylesheet" type="text/css" />
  <script nonce="undefined" src="https://cdn.zingchart.com/zingchart.min.js"></script>
</head>

<body>
  <div class="container">
    <div id="myChart">
      <a class="zc-ref" href="https://www.zingchart.com/">Charts by ZingChart</a>
    </div>
    <div class="list">
      <div class="list__title">
        <div>Tháng</div>
        <div>Kangnam</div>
        <div>Paris</div>
        <div>Hồng Hà</div>
      </div>
      <div id="list__data"></div>
    </div>
    <div class="save__chart">
      <button type="submit" id="save" class="button button--gradientGreen">Lưu</button>
    </div>
  </div>
  <script>
    const dataLocal = localStorage.getItem("data");
    if (!dataLocal) {
      var myConfig = {
        globals: {
          "font-family": "Roboto",
        },
        graphset: [
          {
            type: "area",
            "background-color": "#fff",
            utc: true,
            title: {
              y: "15px",
              text: "Báo cáo doanh thu năm 2022",
              "background-color": "none",
              "font-color": "#05636c",
              "font-size": "24px",
              height: "25px",
              "adjust-layout": true,
            },
            plotarea: {
              "margin-top": "10%",
              "margin-right": "dynamic",
              "margin-bottom": "dynamic",
              "margin-left": "dynamic",
              "adjust-layout": true,
            },
            labels: [
              {
                text: "Kangnam: %plot-2-value",
                "default-value": "",
                color: "#8da0cb",
                x: "20%",
                y: 50,
                width: 120,
                "text-align": "left",
                bold: 0,
                "font-size": "14px",
                "font-weight": "bold",
              },
              {
                text: "Paris: %plot-1-value",
                "default-value": "",
                color: "#66c2a5",
                x: "45%",
                y: 50,
                width: 120,
                "text-align": "left",
                bold: 0,
                "font-size": "14px",
                "font-weight": "bold",
              },
              {
                text: "Hồng Hà: %plot-0-value",
                "default-value": "",
                color: "#fc8d62",
                x: "70%",
                y: 50,
                width: 120,
                "text-align": "left",
                bold: 0,
                "font-size": "14px",
                "font-weight": "bold",
              },
            ],
            "scale-x": {
              label: {
                text: "Năm 2022",
                "font-size": "14px",
                "font-weight": "normal",
                "offset-x": "10%",
                "font-angle": 360,
              },
              item: {
                "text-align": "center",
                "font-color": "#05636c",
              },
              zooming: 1,
              "max-labels": 12,
              labels: [
                "Tháng<br>1",
                "Tháng<br>2",
                "Tháng<br>3",
                "Tháng<br>4",
                "Tháng<br>5",
                "Tháng<br>6",
                "Tháng<br>7",
                "Tháng<br>8",
                "Tháng<br>9",
                "Tháng<br>10",
                "Tháng<br>11",
                "Tháng<br>12",
              ],
              "max-items": 12,
              "items-overlap": true,
              guide: {
                "line-width": "0px",
              },
              tick: {
                "line-width": "2px",
              },
            },
            "crosshair-x": {
              "line-color": "#fff",
              "line-width": 1,
              "plot-label": {
                visible: false,
              },
            },
            "scale-y": {
              values: "0:1500000:300000",
              item: {
                "font-color": "#05636c",
                "font-weight": "normal",
              },
              label: {
                text: "Doanh số",
                "font-size": "14px",
              },
              guide: {
                "line-width": "0px",
                alpha: 0.2,
                "line-style": "dashed",
              },
            },
            plot: {
              "line-width": 2,
              marker: {
                size: 1,
                visible: false,
              },
              tooltip: {
                "font-family": "Roboto",
                "font-size": "15px",
                text: "Doanh thu %v %t vào %data-days",
                "text-align": "left",
                "border-radius": 5,
                padding: 10,
              },
            },
            series: [
              {
                values: [
                  24498, 51450, 76800, 99793, 2000, 42150, 220623, 71560,
                  129100, 124875, 277450, 0,
                ],
                "data-days": [
                  "Tháng 1",
                  "Tháng 2",
                  "Tháng 3",
                  "Tháng 4",
                  "Tháng 5",
                  "Tháng 6",
                  "Tháng 7",
                  "Tháng 8",
                  "Tháng 9",
                  "Tháng 10",
                  "Tháng 11",
                  "Tháng 12",
                ],
                "line-color": "#fc8d62",
                aspect: "spline",
                "background-color": "#fc8d62",
                "alpha-area": ".5",
                "font-family": "Roboto",
                "font-size": "14px",
                text: "Hồng Hà",
              },
              {
                values: [
                  88099, 98800, 400475, 248450, 363649, 355100, 497655,
                  332700, 407125, 185922, 178700, 0,
                ],
                "data-days": [
                  "Tháng 1",
                  "Tháng 2",
                  "Tháng 3",
                  "Tháng 4",
                  "Tháng 5",
                  "Tháng 6",
                  "Tháng 7",
                  "Tháng 8",
                  "Tháng 9",
                  "Tháng 10",
                  "Tháng 11",
                  "Tháng 12",
                ],
                "line-color": "#66c2a5",
                "background-color": "#66c2a5",
                "alpha-area": ".3",
                text: "Paris",
                aspect: "spline",
                "font-family": "Roboto",
                "font-size": "14px",
              },
              {
                values: [
                  176240, 355080, 258750, 838230, 318575, 1272780, 1341314,
                  496400, 805932, 699750, 438275, 0,
                ],
                "data-days": [
                  "Tháng 1",
                  "Tháng 2",
                  "Tháng 3",
                  "Tháng 4",
                  "Tháng 5",
                  "Tháng 6",
                  "Tháng 7",
                  "Tháng 8",
                  "Tháng 9",
                  "Tháng 10",
                  "Tháng 11",
                  "Tháng 12",
                ],
                "line-color": "#8da0cb",
                "background-color": "#8da0cb",
                aspect: "spline",
                "alpha-area": "0.2",
                text: "Kangnam",
                "font-family": "Roboto",
                "font-size": "14px",
              },
            ],
          },
        ],
      };
    } else {
      var myConfig = JSON.parse(dataLocal);
    }

    const renderChart = () => {
      ZC.LICENSE = [
        "569d52cefae586f634c54f86dc99e6a9",
        "b55b025e438fa8a98e32482b5f768ff5",
      ];

      zingchart.render({
        id: "myChart",
        data: myConfig,
        height: "100%",
        width: "100%",
      });
    };

    const renderListData = () => {
      let html = "";
      let dataValue = myConfig.graphset[0].series;
      for (let i = 0; i < 12; i++) {
        html += `
              <div class="list__group">
                <div class="list__control">
                  <input type="number" disabled value="${i + 1}">
                </div>
               
                <div class="list__control list__item">
                  <input type="number" class="dataParis dataParis${i}" value="${dataValue[1].values[i]}">
                </div>
                <div class="list__control list__item">
                  <input type="number" class="dataHongha dataHongha${i}" value="${dataValue[2].values[i]}">
                </div>
                <div class="list__control list__item">
                  <input type="number" class="dataKangnam dataKangnam${i}" value="${dataValue[0].values[i]}">
                </div>
              </div>
            `;
      }
      document.getElementById("list__data").insertAdjacentHTML("beforeend", html);
    };
    renderListData();
    renderChart();

    document.getElementById("save").addEventListener("click", function (e) {
      e.preventDefault();
      let elms = document.querySelectorAll(".list__item .dataKangnam");
      let elms2 = document.querySelectorAll(".list__item .dataParis");
      let elms3 = document.querySelectorAll(".list__item .dataHongha");
      let dataValueKn = [];
      let dataValuePr = [];
      let dataValueHh = [];
      [...elms].map((item, index) => {
        // console.log(item.value);
        let valueKn = item.value;
        // let valueKn = item.getElementsByClassName(`dataKangnam${index}`)[0].value;
        // let valuePr = item.getElementsByClassName(`dataParis${index}`)[0].value;
        // let valueHh = item.getElementsByClassName(`dataHongha${index}`)[0].value;

        dataValueKn.push(Number(valueKn));
        // dataValuePr.push(Number(valuePr));
        // dataValueHh.push(Number(valueHh));
      });
      [...elms2].map((item, index) => {
        // console.log(item.value);
        // let valueKn = item.value;
        let valuePr = item.value;
        // let valueKn = item.getElementsByClassName(`dataKangnam${index}`)[0].value;
        // let valuePr = item.getElementsByClassName(`dataParis${index}`)[0].value;
        // let valueHh = item.getElementsByClassName(`dataHongha${index}`)[0].value;

        // dataValueKn.push(Number(valueKn));
        dataValuePr.push(Number(valuePr));
        // dataValueHh.push(Number(valueHh));
      });
      [...elms3].map((item, index) => {
        // console.log(item.value);
        // let valueKn = item.value;
        let valueHh = item.value;
        // let valueKn = item.getElementsByClassName(`dataKangnam${index}`)[0].value;
        // let valuePr = item.getElementsByClassName(`dataParis${index}`)[0].value;
        // let valueHh = item.getElementsByClassName(`dataHongha${index}`)[0].value;

        // dataValueKn.push(Number(valueKn));
        dataValueHh.push(Number(valueHh));
        // dataValueHh.push(Number(valueHh));
      });
      Object.assign(myConfig.graphset[0].series[0].values, dataValueKn);
      Object.assign(myConfig.graphset[0].series[1].values, dataValuePr);
      Object.assign(myConfig.graphset[0].series[2].values, dataValueHh);
      const myJSON = JSON.stringify(myConfig);
      localStorage.setItem("data", myJSON);
      renderChart();
    });
  </script>
</body>

</html>